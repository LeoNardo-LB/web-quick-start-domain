## Context

当前 OrderAggr 聚合根已有订单状态字段，但缺少状态流转的前置验证能力。业务场景中，在执行 `updateStatus()` 等状态变更操作前，需要先判断目标状态是否可达，避免非法状态流转。

**约束**:

- 遵循 DDD 领域驱动设计原则
- 状态流转规则应封装在领域层内部
- 不引入外部依赖

## Goals / Non-Goals

**Goals:**

- 在 OrderAggr 中添加 `canTransitionTo(OrderStatus targetStatus)` 方法
- 实现完整的状态流转规则验证
- 提供清晰的业务语义
- 100% 单元测试覆盖

**Non-Goals:**

- 不修改现有状态变更方法的行为
- 不添加 Application 层或 Adapter 层的 API
- 不涉及持久化或数据库变更

## Decisions

### 1. 方法放置位置

**决策**: 在 OrderAggr 聚合根中添加实例方法

**理由**:

- 状态流转是聚合根的内在行为
- 需要访问当前状态 `this.status`
- 符合 DDD "富领域模型" 原则

**替代方案**:

- ❌ 在 OrderStatus 枚举中添加静态方法 - 无法访问订单当前状态
- ❌ 创建独立的 OrderStatusTransition 领域服务 - 增加不必要的复杂度

### 2. 状态流转规则表示

**决策**: 在方法内部使用 switch-case 实现规则

**理由**:

- 规则数量有限（6种状态），switch-case 足够清晰
- 无需引入状态机框架
- 易于理解和维护

**替代方案**:

- ❌ 使用状态机框架 (Spring State Machine) - 过度设计
- ❌ 使用 Map 结构存储规则 - 可读性差

### 3. 返回值类型

**决策**: 返回 boolean

**理由**:

- 符合方法命名 `can*` 的语义
- 调用方只需知道是否允许流转
- 保持简单

**替代方案**:

- ❌ 返回 Optional<String> 包含拒绝原因 - 当前需求不需要

## Risks / Trade-offs

| 风险            | 缓解措施                         |
|---------------|------------------------------|
| 状态流转规则未来可能变复杂 | 预留重构空间，可提取为独立规则类             |
| 调用方可能忘记先调用验证  | 在 `updateStatus()` 方法中内部调用验证 |
